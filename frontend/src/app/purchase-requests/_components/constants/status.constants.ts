import { TabType } from '../types/purchase-request.types';

// Константы для групп статусов (соответствуют PurchaseRequestStatusGroup enum)
export const ALL_STATUS_GROUPS = [
  'Не установлен',
  'Проект',
  'Заявка на согласовании',
  'Заявка не согласована',
  'Заявка не утверждена',
  'Закупка не согласована',
  'Заявка у закупщика',
  'Спецификация создана - Архив',
  'Спецификация в работе',
  'Спецификация не согласована',
  'Договор в работе',
  'Спецификация подписана',
  'Договор подписан',
];

export const DEFAULT_STATUS_GROUPS = ALL_STATUS_GROUPS;

// Определяем группы статусов для каждой вкладки
export const TAB_STATUS_GROUPS: Record<TabType, string[]> = {
  'in-work': [
    'Заявка у закупщика',
    'Спецификация в работе',
    'Договор в работе',
  ],
  'completed': ['Спецификация подписана', 'Договор подписан'],
  'project-rejected': ['Проект', 'Заявка на согласовании', 'Заявка не согласована', 'Заявка не утверждена', 'Закупка не согласована', 'Спецификация создана - Архив', 'Спецификация не согласована'],
  'hidden': [], // Для скрытых заявок не фильтруем по группе статуса, только по excludeFromInWork
  'all': ALL_STATUS_GROUPS,
};

// Кэш для метаданных (годы и уникальные значения)
export const CACHE_KEY = 'purchaseRequests_metadata';
export const CACHE_TTL = 5 * 60 * 1000; // 5 минут

/**
 * Лимиты выборки для фильтров и сводки (основная таблица — по 100 на страницу).
 * Эти запросы нужны только чтобы построить списки в фильтрах и сводку по закупщикам.
 */
export const FETCH_LIMITS = {
  /** Уникальные значения для фильтров (закупщик, инициатор, статус и т.д.). Кэш 5 мин. */
  METADATA_PAGE_SIZE: 2_000,
  /** Уникальные группы статусов по вкладке (значений мало, хватает небольшой выборки). */
  AVAILABLE_STATUSES_PAGE_SIZE: 1_000,
  /** Сводная таблица по закупщикам — агрегаты по заявкам «в работе». */
  SUMMARY_PAGE_SIZE: 1_000,
} as const;

// Legacy: старые константы для обратной совместимости (могут быть удалены позже)
export const ALL_STATUSES = [
  'Заявка на согласовании',
  'На согласовании',
  'Заявка у закупщика',
  'На утверждении',
  'Утверждена',
  'Заявка утверждена',
  'Согласована',
  'Заявка не согласована',
  'Заявка не утверждена',
  'Проект',
  'Неактуальна',
  'Не Актуальная',
  'Спецификация создана',
  'Спецификация создана - Архив',
  'Спецификация на согласовании',
  'Спецификация подписана',
  'Договор создан',
  'Договор подписан',
  'Закупка создана',
  'Закупка не согласована',
  'Закупка завершена',
];

export const DEFAULT_STATUSES = ALL_STATUSES.filter(
  (s) => s !== 'Неактуальна' && s !== 'Не Актуальная'
);

// Legacy: TAB_STATUSES для обратной совместимости
export const TAB_STATUSES: Record<TabType, string[]> = {
  'in-work': [
    'Заявка у закупщика',
    'На утверждении',
    'Спецификация создана',
    'Спецификация на согласовании',
    'Закупка создана',
    'Договор создан',
    'Заявка утверждена',
    'Утверждена',
    'Закупка завершена',
  ],
  'completed': ['Спецификация подписана', 'Договор подписан'],
  'project-rejected': [
    'Проект',
    'Заявка на согласовании',
    'На согласовании',
    'Заявка не согласована',
    'Заявка не утверждена',
    'Закупка не согласована',
    'Спецификация создана - Архив',
  ],
  'hidden': [],
  'all': ALL_STATUSES,
};
