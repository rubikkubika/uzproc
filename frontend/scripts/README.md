# Скрипты конвертации

## Конвертация Excel в CSV

Скрипт `convert-excel-to-csv.js` конвертирует Excel файлы в CSV с правильной обработкой объединенных ячеек.

### Проблема

При обычной конвертации Excel в CSV объединенные ячейки не сохраняются правильно - вместо того, чтобы дублировать значения объединенных ячеек в пустых местах, они остаются пустыми. Это приводит к проблемам при парсинге данных.

### Решение

Скрипт:
1. Читает Excel файл с помощью библиотеки `xlsx`
2. Определяет все объединенные ячейки (merged cells)
3. Заполняет пустые ячейки значениями из объединенных ячеек
4. Сохраняет результат в CSV файл с разделителем `;` (точка с запятой)

### Использование

#### Вариант 1: Через npm скрипт

```bash
cd frontend
npm run convert-excel "images/Отчет 25.11.xlsx" "images/для фронта.csv"
```

#### Вариант 2: Напрямую через node

```bash
cd frontend
node scripts/convert-excel-to-csv.js "images/Отчет 25.11.xlsx" "images/для фронта.csv"
```

#### Параметры

- Первый параметр (обязательный): путь к Excel файлу
  - Если путь относительный, скрипт ищет файл в папке `images/`
  - Можно указать только имя файла, если он находится в `images/`
  
- Второй параметр (опциональный): путь для сохранения CSV файла
  - Если не указан, создается файл с тем же именем, но расширением `.csv`
  - Если путь относительный, файл сохраняется в папку `images/`

### Примеры

```bash
# Конвертация файла из папки images
npm run convert-excel "Отчет 25.11.xlsx"

# Конвертация с указанием выходного файла
npm run convert-excel "Отчет 25.11.xlsx" "для фронта.csv"

# Абсолютные пути
npm run convert-excel "C:/path/to/file.xlsx" "C:/path/to/output.csv"
```

### Важные замечания

1. Скрипт обрабатывает только первый лист Excel файла
2. Разделитель в CSV файле - точка с запятой (`;`)
3. Скрипт автоматически заполняет пустые ячейки значениями из объединенных ячеек
4. Сохраняется резервная копия существующего CSV файла (если он есть)

